<div class="container-xl mb-5">
    <div class="align_search_filter">
      <div class="input-group input-group-sm input-group-inline input_box_icons_alignment">
      <span class="input-group-text pe-2">
        <i class="bi bi-search"></i>
      </span>
      <input type="text" class="form-control" [(ngModel)]="searchValue || filterEntity.identifier" placeholder="Search Patient Details" aria-label="Search" aria-describedby="">
      </div>
      <img src="/assets/images/filter_icon.svg"(click)="togglefilterDiv()" class="icons_align"/>
      <img src="/assets/images/setting.svg" class="filter_align icons_align"/>
    </div>
  </div>
  <div class="container filter_options_container patient_list_filter" [hidden]="isShowFilter">
    <div class="row">
      <div class="col-sm-2">
        <mat-form-field appearance="fill" class="details_page alignment_date condition_select">
          <mat-select multiple [(value)]="selected" placeholder="Condition">
            <mat-option *ngFor="let topping of selectedMedicalConditions" [value]="topping">{{topping}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <!-- <div class="col-sm">
        <mat-form-field appearance="fill" class="details_page alignment_date condition_select">
          <mat-select multiple [(value)]="selected" placeholder="Activity Type">
            <mat-option [value]="1">Physical</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-sm">
        <mat-form-field appearance="fill" class="details_page alignment_date condition_select">
          <mat-select multiple [(value)]="selected" placeholder="Time">
            <mat-option [value]="15">15 mins. or less</mat-option>
            <mat-option [value]="30">30 mins. or less</mat-option>
            <mat-option [value]="45">45 mins. or less</mat-option>
            <mat-option [value]="60">60 mins. or less</mat-option>
          </mat-select>
        </mat-form-field>
      </div> -->
      <div class="col-sm-2">
        <mat-form-field class="details_page alignment_date condition_select" appearance="fill">
          <input matInput [matDatepicker]="picker" placeholder="Date">
          <mat-datepicker-toggle matSuffix [for]="picker">
            <!-- <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon> -->
          </mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
      </div>

    </div>
  </div>
  <!-- Container -->
  <div class="container-xl mt-5">
    <div class="rounded-top bg-light p-5">
      <div class="row">
        <div class="col">
          <h6>Patient List</h6>
        </div>
        <!-- <div class="col text-end">
          <span class="me-3">1-10 of 67 </span>

          <span role="button" class="me-1">
            < </span>
              <span role="button"> > </span>
               <i class="fa fa-less-than me-1"></i>
            <i class="fa fa-greater-than"></i>
        </div> -->
      </div>
    </div>
    <div class="table-responsive">
      <table mat-table [dataSource]="dataSource" matTableFilter [exampleEntity]="filterEntity"
      [filterType]="filterType" matSort class="mat-elevation-z8" class="patients_table" >

        <!--- Note that these columns can be defined in any order.
              The actual rendered columns are set as a property on the row definition" -->

        <!-- Position Column -->
        <ng-container matColumnDef="total_count">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header"> <div class="form-check">
            <mat-checkbox (change)="$event ? selection.toggle(row) : null" class="custom_checkbox"></mat-checkbox>
          </div> </th>
          <td mat-cell *matCellDef="let element">
            <div class="form-check">
              <mat-checkbox class="custom_checkbox" [checked]="selection.isSelected(row)"></mat-checkbox>
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="label_star">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header"></th>
          <td mat-cell *matCellDef="let element">
            <i class="bi bi-star custom_star_color"></i>
          </td>
        </ng-container>
        <!-- Name Column -->
        <ng-container matColumnDef="identifier">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="custom_table_header"> Identifier
            <!-- <button (click)=toggleDisplayDiv()><mat-icon>filter_alt</mat-icon></button> -->
            <input [hidden]="isShowDiv" matInput [(ngModel)]="filterEntity.identifier" value="{{searchValue}}">
          </th>
          <td mat-cell *matCellDef="let element" class="clicked_class" routerLink="/app/patients/{{element.id}}">
            <span class="text-heading font-semibold"> {{element.nickname}} </span>
              <!-- <a class="text-heading font-semibold" href="/app/patients/{{element.id}}">click</a> -->
          </td>
        </ng-container>

        <!-- Weight Column -->
        <ng-container matColumnDef="medical_condition">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header"> Condition
            <input [hidden]="isShowDiv" matInput [(ngModel)]="filterEntity.medicalConditions" value="{{searchValue}}">
          </th>
          <td mat-cell *matCellDef="let element" class="clicked_class" routerLink="/app/patients/{{element.id}}">
            <p></p>
            <!-- <span class="badge bg-primary m-2"
                                                                                      *ngFor="let condition of element.medicalConditions | keyvalue">{{condition.key}}</span> -->
          </td>
        </ng-container>

        <!-- Symbol Column -->
        <ng-container matColumnDef="last_session">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header" mat-sort-header> Last Active </th>
          <td mat-cell *matCellDef="let element" class="custom_table_text clicked_class" routerLink="/app/patients/{{element.id}}">
            <span *ngFor="let game of element.games">
              {{ game.createdAt | date:'short'}}
              <!-- Hacky shit. Expects the API to only return 1 result here. -->
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="last_activity">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header" mat-sort-header> Last Activity </th>
          <td mat-cell *matCellDef="let element" class="custom_table_text clicked_class" routerLink="/app/patients/{{element.id}}">
            <span *ngFor="let game of element.games">
              {{ game.game | titlecase }}
            </span>
          </td>
        </ng-container>

        <ng-container matColumnDef="time_spent">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header" mat-sort-header> Time Spent </th>
          <td mat-cell *matCellDef="let element" class="custom_table_text clicked_class" routerLink="/app/patients/{{element.id}}">
              {{ element.games_aggregate && element.games_aggregate.aggregate ? element.games_aggregate.aggregate.sum.totalDuration : 0 }} minutes
          </td>
        </ng-container>

        <ng-container matColumnDef="sessions_aggregate">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header" mat-sort-header> Total Time of Movement </th>
          <td mat-cell *matCellDef="let element" class="custom_table_text clicked_class" routerLink="/app/patients/{{element.id}}">
              {{ element.games_aggregate && element.games_aggregate.aggregate ? element.games_aggregate.aggregate.sum.totalDuration : 0 }} minutes
          </td>
        </ng-container>

        <ng-container matColumnDef="achievement_ratio">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header" mat-sort-header> Achievement Ratio </th>
          <td mat-cell *matCellDef="let element" class="custom_table_text clicked_class" routerLink="/app/patients/{{element.id}}">
            <div class="row align-items-center">
              <div class="col-2">{{'90'}}%</div>
              <div class="col flex-grow">
                <div class="progress progress-sm">
                  <div class="progress-bar bg-primary" role="progressbar" style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
              </div>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="custom_table_header"></th>
          <td mat-cell *matCellDef="let element">
              <div class="dropdown">
                <a class="text-muted" (click)="null" role="button" data-bs-toggle="dropdown" aria-haspopup="true"
                  aria-expanded="false">
                  <i class="bi bi-three-dots-vertical"></i>
                </a>
                <div class="dropdown-menu dropdown-menu-end">
                  <a href="#!" class="dropdown-item">
                    Edit Patient Details
                  </a>
                  <a href="#!" class="dropdown-item">
                    Archive Patient Details
                  </a>
                  <a href="#!" class="dropdown-item">
                    Open Patient Profile
                  </a>
                </div>
              </div>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="row_hover"></tr>
      </table>
      <mat-paginator [pageSize]="10"
        #TableOnePaginator="matPaginator" showFirstLastButtons>
      </mat-paginator>
    </div>

  </div>
