<header class="px-3 px-lg-7 pt-7 custom_header">
  <div class="container-xl">
    <div>
      <div class="row custom_alignment p-5">
        <div class="col-md-6 col-12 mb-3 mb-md-0">
          <!-- Title -->
          <xng-breadcrumb separator=">"></xng-breadcrumb>
          <router-outlet></router-outlet>
          <h1 class="h2 mb-0 ls-tight heading_text mt-5">{{ getName(gameDetails.game) }}</h1>
        </div>
        <div *ngIf="showDownloadSession" class="col-md-6 col-md-8 col-lg-4">
          <button (click)="downloadSession()">Download Session</button>
        </div>
        <!-- Actions -->
      </div>
    </div>
  </div>
</header>
<div class="container pt-5">
  <div class="card shadow-inset shadow-6 pt-5 pb-5 mt-5">
    <div class="container">

      <div class="row align-items-center">
        <div class="col-lg-8">
          <div class="row">
            <div class="col-lg-6">
              <div class="card mb-8 ml-8 shadow-2">
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <span class="h6 font-semibold text-muted text-sm d-block mb-2">Session Duration</span>
                      <span class="h3 font-bold mb-0">{{ gameDetails.totalDuration }}</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape text-white text-lg rounded-circle" style="background-color: #8CDFB3;">
                        <i class="bi bi-hourglass-split"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card mb-8 ml-8 shadow-2">
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <span class="h6 font-semibold text-muted text-sm d-block mb-2">Average reaction time</span>
                      <span class="h3 font-bold mb-0">{{ gameDetails.avgReactionTime }} ms</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape text-white text-lg rounded-circle" style="background-color: #FFADBA">
                        <i class="bi bi-clock-history"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6">
              <div class="card mb-8 ml-8 shadow-2">
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <span class="h6 font-semibold text-muted text-sm d-block mb-2">Session Completion</span>
                      <span class="h3 font-bold mb-0">{{ sessionCompletionRatio }}%</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape text-white text-lg rounded-circle" style="background-color:#FAB592;">
                        <i class="bi bi-hourglass-split"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="card mb-8 ml-8 shadow-2">
                <div class="card-body">
                  <div class="row">
                    <div class="col">
                      <span class="h6 font-semibold text-muted text-sm d-block mb-2">Total Achievement Ratio</span>
                      <span class="h3 font-bold mb-0">{{ gameDetails.totalPerformanceRatio }}%</span>
                    </div>
                    <div class="col-auto">
                      <div class="icon icon-shape text-white text-lg rounded-circle invert-vertically"
                        style="background-color: #7895FF;">
                        <i class="bi bi-file-bar-graph"></i>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="card shadow-2">
            <!-- Image -->
            <div class="p-2">
              <img src="../../../../../assets/images/session-details.png" alt="..." class="card-img">
            </div>
            <div class="card-body">
              <div class="info mb-7">
                <h2 class="h4">Identifer: {{ gameDetails.patientByPatient.identifier }}</h2>
                <span class="d-block text-muted text-sm font-semibold">Session Date: {{ gameDetails.createdAt | date
                  }}</span>
              </div>
              <div class="info mb-7">
                <h2 class="h4">Condition</h2>
                <span class="d-block text-muted text-sm font-semibold">{{ patientConditions }}</span>
              </div>
              <div class="info">
                <h2 class="h4">Severity</h2>
                <span class="d-block text-muted text-sm font-semibold">Moderate</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Charts -->
  <div class="container mt-8">
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <div class="card-header">
              <h2 style="color: #000066;">Achievement Ratio</h2><br>
              <span>
                <h5 style="color: #000066;">
                  {{ gameDetails.careplanByCareplan.name }}
                </h5>
              </span>
            </div>
            <canvas class="chart-canvas" id="sessionAchievementChart" width="500" height="500"></canvas>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <div class="card-header">
              <h2 style="color: #000066;">Reaction Time</h2><br>
              <span>
                <h5 style="color: #000066;">
                  {{ gameDetails.careplanByCareplan.name }}
                </h5>
              </span>
            </div>
            <canvas class="chart-canvas" id="sessionReactionTimeChart" width="500" height="500"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Performance Analysis -->
  <div class="card shadow-inset shadow-6 mt-8 mb-12">
    <div class="container mb-8">
      <h1 class="h3 ls-tight font-bolder mb-8 pt-8">Performance Analysis</h1>
      <div class="row">
        <div *ngFor="let activity of activityDetails" class="col-lg-4">
          <div class="card">
            <!-- Image -->
            <div class="p-2">
              <img (click)="openActivityDetailsPage(activity.id!, activity)" alt="..."
                src="../../../../../assets/images/activity/sit-to-stand.png" class="card-img performance_click">
            </div>
            <div class="card-body pb-0">
              <div class="container align-items-center">
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Activity
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.name }}
                  </div>
                </div>
                <hr>
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Prompt
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.prompt }}
                  </div>
                </div>
                <hr>
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Total Time
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.durationInStr }}
                  </div>
                </div>
                <hr>
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Reps. Completed
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.reps }}
                  </div>
                </div>
                <hr>
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Correct Motion
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.correctMotions }}
                  </div>
                </div>
                <hr>
                <div class="row mt-2 mb-2">
                  <div class="col-lg-6">
                    Average Reaction Time
                  </div>
                  <div class="col-lg-6 text-dark">
                    {{ activity.reactionTime }}
                  </div>
                </div>
                <hr>
                <div class="mb-4">
                  <span>Accuracy</span>
                  <div class="d-flex align-items-center">
                    <div style="width: 85%;">
                      <div class="progress progress-sm shadow-none">
                        <div class="progress-bar" role="progressbar"
                          style="width: {{ activity.achievementRatio }}%; background-color: #8CDFB3" aria-valuemin="0"
                          aria-valuemax="100"></div>
                      </div>
                    </div>
                    <div class="col px-0 text-end">
                      <span class="text-heading text-sm">{{ activity.achievementRatio }}%</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Use these when you have more than one activities. -->
        <!-- <div class="col-lg-4">
          Hello
        </div>
        <div class="col-lg-4">
          Hello
        </div> -->
      </div>
    </div>
  </div>

  <!-- Notes -->
  <div class="card mb-5">
    <div class="card-body">
      <div class="row">
        <div class="col-lg-10">
          <h3 class="h4">No notes added yet.</h3>
          <p class="mt-4 mb-6">
            Create notes of patient to keep track of patient observations
          </p>
        </div>
        <div class="col mt-6">
          <a href="/app/patients/dd8e4b79-0497-4093-ab3a-c2feeb2fac45/notes" class="btn btn-sm btn-primary">
            <i class="bi bi-plus-square-fill"></i>
            Add Notes
            <span>&gt;</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
